(()=>{"use strict";const e=class{constructor({data:e,handleCardClick:t},s){this._title=e.title,this._link=e.link,this._handleCardClick=t,this._templateSelector=s}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".place").cloneNode(!0)}_setEventListeners(e){e.querySelector(".button_action_like").addEventListener("click",(e=>{e.target.classList.toggle("button_action_like--active")})),e.querySelector(".button_action_trash").addEventListener("click",(()=>{e.remove()})),e.querySelector(".place__image").addEventListener("click",(()=>{this._handleCardClick()}))}generateCard(){return this._element=this._getTemplate(),this._element.querySelector(".place__title").textContent=this._title,this._element.querySelector(".place__image").setAttribute("src",this._link),this._element.querySelector(".place__image").setAttribute("alt",this._title),this._setEventListeners(this._element),this._element}},t=class{constructor(e,t){this._config=e,this._formElement=t,this._inputList=Array.from(t.querySelectorAll(e.inputSelector)),this._buttonElement=t.querySelector(e.submitButtonSelector)}_showInputError(e,t){const s=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._config.inputErrorClass),s.textContent=t,s.classList.add(this._config.errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.remove(this._config.inputErrorClass),t.classList.remove(this._config.errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?this._buttonElement.classList.add(this._config.inactiveButtonClass):this._buttonElement.classList.remove(this._config.inactiveButtonClass)}_setEventListeners(){this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}enableValidation(){this._setEventListeners(),this._toggleButtonState()}},s=class{constructor(e){this._popup=document.querySelector(e),this._form=document.querySelector(".form"),this._handlerOnEsc=this._handleEscClose.bind(this),this._handlerSupClose=this._handleSuperClose.bind(this)}open(){this._form.classList.add("form_mode_active"),this.setEventListeners()}close(){this._form.classList.remove("form_mode_active"),this._removeListeners()}_handleEscClose(e){"Escape"===e.key&&this.close()}_handleSuperClose(e){this._popup.contains(e.target)||this.close()}_removeListeners(){document.removeEventListener("keydown",this._handlerOnEsc),this._form.removeEventListener("click",this._handlerSupClose)}setEventListeners(){this._popup.querySelector(".button_action_close").addEventListener("click",(()=>{this.close()})),this._form.addEventListener("click",this._handlerSupClose),document.addEventListener("keydown",this._handlerOnEsc)}},n=class extends s{constructor({submitCallback:e},t){super(t),this._submitCallback=e,this._submitButton=this._popup.querySelector(".button_action_create"),this._handlerSubmit=this._handleSubmit.bind(this),this._handlerSubmitOnEnter=this._hanldeSubmitOnEnter.bind(this)}_getInputValues(){const e={};return this._popup.querySelectorAll(".form__input").forEach((t=>{e[t.name]=t.value})),e}_reset(){this._popup.querySelectorAll(".form__input").forEach((e=>{e.value=""}))}open(){super.open(),this.setEventListeners(),this._popup.classList.add("form__set_mode_active")}close(){super.close(),this._removeListeners(),this._popup.classList.remove("form__set_mode_active"),this._reset()}_handleSubmit(e){e.preventDefault(),this._submitCallback()}_hanldeSubmitOnEnter(e){"Enter"===e.key&&(e.preventDefault(),this._submitButton.classList.contains("button_action_create-inactive")||this._submitCallback())}setEventListeners(){super.setEventListeners(),this._popup.addEventListener("submit",this._handlerSubmit),document.addEventListener("keydown",this._handlerSubmitOnEnter)}_removeListeners(){super._removeListeners(),this._popup.removeEventListener("submit",this._handlerSubmit),document.removeEventListener("keydown",this._handlerSubmitOnEnter)}},i="#place-template",r=document.querySelector("#profile"),o=document.querySelector("#image"),a=document.querySelector("#name-input"),l=document.querySelector("#employment-input"),c=document.querySelector(".button_action_edit"),u=document.querySelector(".button_action_add"),_=document.querySelector("#submit-profile"),m=document.querySelector("#submit-image"),p=new class extends s{constructor(e){super(e),this._image=this._popup.querySelector(".popup__image"),this._title=this._popup.querySelector(".popup__title")}open({title:e,link:t}){super.open(),this._popup.classList.add("popup_mode_active"),this._image.src=t,this._title.textContent=e,this._image.alt=t}close(){super.close(),this._popup.classList.remove("popup_mode_active")}}(".popup"),h=new class{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=document.querySelector(s)}rendererItems(){this._items.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}({items:[{title:"Valle de Yosemite",link:"https://practicum-content.s3.us-west-1.amazonaws.com/new-markets/WEB_sprint_5/ES/yosemite.jpg"},{title:"Lago Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/new-markets/WEB_sprint_5/ES/lake-louise.jpg"},{title:"MontaÃ±as Calvas",link:"https://practicum-content.s3.us-west-1.amazonaws.com/new-markets/WEB_sprint_5/ES/bald-mountains.jpg"},{title:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/new-markets/WEB_sprint_5/ES/latemar.jpg"},{title:"Parque Nacional de la Vanoise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/new-markets/WEB_sprint_5/ES/vanoise.jpg"},{title:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/new-markets/WEB_sprint_5/ES/lago.jpg"}],renderer:t=>{const s=new e({data:t,handleCardClick:()=>{p.open(t)}},i).generateCard();h.addItem(s)}},".places"),d=new class{constructor({nameSelector:e,employmentSelector:t}){this._nameElement=document.querySelector(e),this._employmentElement=document.querySelector(t)}getUserInfo(){return{name:this._nameElement.textContent,employment:this._employmentElement.textContent}}setUserInfo({name:e,employment:t}){this._nameElement.textContent=e,this._employmentElement.textContent=t}}({nameSelector:".profile__username",employmentSelector:".profile__useremployment"}),v=new n({submitCallback:()=>{const e=v._getInputValues();d.setUserInfo(e),v.close()}},"#profile"),E=new n({submitCallback:()=>{const t=E._getInputValues(),s=new e({data:t,handleCardClick:()=>{p.open(t)}},i).generateCard();h.addItem(s),E.close()}},"#image"),S=new t({formSelector:".form__set",inputSelector:".form__input",submitButtonSelector:"#submit-profile",inactiveButtonClass:"button_action_create-inactive",inputErrorClass:"form__input_type-error",errorClass:"form__input-error_active"},r),b=new t({formSelector:".form__set",inputSelector:".form__input",submitButtonSelector:"#submit-image",inactiveButtonClass:"button_action_create-inactive",inputErrorClass:"form__input_type-error",errorClass:"form__input-error_active"},o);c.addEventListener("click",(()=>{const e=d.getUserInfo();a.value=e.name,l.value=e.employment,S.enableValidation(),v.open()})),u.addEventListener("click",(()=>{E.open(),b.enableValidation()})),_.addEventListener("click",(e=>{e.preventDefault(),v._submitCallback()})),m.addEventListener("click",(e=>{e.preventDefault(),E._submitCallback()})),h.rendererItems()})();